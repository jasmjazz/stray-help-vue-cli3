(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2eaf5445"],{"13d2":function(t,a,s){"use strict";s("b06c")},"4a2f":function(t,a,s){"use strict";s("dfbe")},"56a6":function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"message-alert"},t._l(t.messages,(function(a,e){return s("div",{key:e,staticClass:"alert",class:"alert-"+a.status},[s("span"),t._v(t._s(a.message)+"\n  ")])})),0)},i=[],n=(s("ac6a"),{data:function(){return{messages:[]}},methods:{updateMessage:function(t,a){var s=Math.floor(new Date/1e3);this.messages.push({message:t,status:a,timestamp:s}),this.removeMessageWithTiming(s)},removeMessageWithTiming:function(t){var a=this;setTimeout((function(){a.messages.forEach((function(s,e){s.timestamp===t&&a.messages.splice(e,1)}))}),1400)}},created:function(){var t=this;t.$bus.$on("message: push",(function(a){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";t.updateMessage(a,s)}))}}),c=n,r=(s("4a2f"),s("2877")),o=Object(r["a"])(c,e,i,!1,null,null,null);a["a"]=o.exports},"9be3":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"wrap"},[s("loading",{attrs:{active:t.isLoading,loader:"dots"},on:{"update:active":function(a){t.isLoading=a}}}),s("Alert"),t._m(0),s("div",{staticClass:"card border-1"},[s("div",{staticClass:"card-body checkcart"},[0===t.cart.length?s("h4",{staticClass:"text-center",staticStyle:{padding:"50px"}},[t._v("還沒有選擇糧食哦！")]):s("ul",[t._l(t.cart,(function(a){return s("li",{key:a.id},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2 p-0"},[s("a",{staticClass:"icon",on:{click:function(s){return s.preventDefault(),t.delCart(a.id)}}},[s("i",{staticClass:"fas fa-trash trash",staticStyle:{"font-size":"18px"}})])]),s("div",{staticClass:"col-7 p-0"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 col-md-6"},[s("p",[t._v(t._s(a.title))])]),s("div",{staticClass:"col-12 col-md-6"},[s("i",{staticClass:"far fa-minus-square",staticStyle:{"font-size":"20px","vertical-align":"text-bottom"},on:{click:function(s){return t.editNum(a,-1)}}}),s("span",{staticStyle:{"font-size":"18px","margin-left":"15px","margin-right":"15px"}},[t._v("\n                    "+t._s(a.qty)+"\n                  ")]),s("i",{staticClass:"far fa-plus-square",staticStyle:{"font-size":"20px","vertical-align":"text-bottom"},on:{click:function(s){return t.editNum(a,1)}}})])])]),s("div",{staticClass:"col-3 p-0 text-right"},[s("p",{staticStyle:{"padding-right":"15px"}},[t._v("\n                NT "+t._s(t._f("currency")(a.price))+"\n              ")])])]),s("hr")])})),t.cart.length>0?s("p",{staticClass:"text-right",staticStyle:{"font-weight":"bold","font-size":"18px"}},[t._v("\n          總計 NT "+t._s(t._f("currency")(t.money))+"\n        ")]):t._e()],2)])]),s("div",{staticClass:"row pay"},[t.cart.length>0?s("div",{staticClass:"col text-right"},[s("button",{staticClass:"btn btn-primary",staticStyle:{"margin-right":"15px",opacity:"0.6"},attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),t.$router.push("/products")}}},[t._v("\n        再逛逛\n      ")]),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.nextStep}},[t._v("\n        確定捐糧\n      ")])]):s("div",{staticClass:"col text-right"},[s("router-link",{attrs:{to:{name:"Products"}}},[s("button",{staticClass:"btn btn-primary"},[t._v("\n          去逛逛\n        ")])])],1)]),t._m(1)],1)},i=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"row sop"},[s("div",{staticClass:"col-md-4 col-sm-12"},[s("div",{staticClass:"alert alert-success",staticStyle:{"font-weight":"bold"},attrs:{role:"alert"}},[t._v("\n        1. 糧食明細\n      ")])]),s("div",{staticClass:"col-md-4 col-sm-12"},[s("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n        2. 填寫資料\n      ")])]),s("div",{staticClass:"col-md-4 col-sm-12"},[s("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n        3. 完成捐糧\n      ")])])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"modal",attrs:{id:"leaveModal",tabindex:"-1",role:"dialog"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("愛心助糧")]),s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),s("div",{staticClass:"modal-body"},[s("p",[s("i",{staticClass:"fas fa-exclamation-circle"}),t._v("\n          尚未完成助糧流程，請確認是否要離開此頁？\n        ")])]),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-primary btn-stay",attrs:{type:"button","data-dismiss":"modal"}},[t._v("否")]),s("button",{staticClass:"btn btn-primary btn-leave",staticStyle:{opacity:"0.6"},attrs:{type:"button"}},[t._v("是")])])])])])}],n=(s("ac6a"),s("1157")),c=s.n(n),r=s("56a6"),o={name:"CheckCart",data:function(){return{isLoading:!1,cart:[],money:0,continue:!1}},components:{Alert:r["a"]},methods:{getCart:function(){var t=this;t.money=0,t.cart=JSON.parse(localStorage.getItem("cart"))||[],t.cart.length>0&&t.cart.forEach((function(a){t.money+=a.total}))},editNum:function(t,a){var s=parseInt(t.qty+a,10);this.updateCart(t,s)},updateCart:function(t,a){var s=this,e=-1;s.getCart(),s.cart.length>0&&s.cart.forEach((function(a,s){a.id===t.id&&(e=s)})),a>=10?(s.cart[e].qty=10,s.$bus.$emit("message: push","同款糧食不得超過10組！","danger")):s.cart[e].qty=a<=1?1:a;var i=parseInt(s.cart[e].price*s.cart[e].qty,10);s.cart[e].total=i,localStorage.setItem("cart",JSON.stringify(s.cart)),s.getCart()},delCart:function(t){var a=this;a.cart.forEach((function(s,e){s.id===t&&a.cart.splice(e,1)})),localStorage.setItem("cart",JSON.stringify(a.cart)),a.getCart()},addCart:function(){var t=this,a="".concat("https://vue-course-api.hexschool.io","/api/").concat("jasmjazz","/cart");t.isLoading=!0,t.cart=JSON.parse(localStorage.getItem("cart"))||[],t.cart.forEach((function(s){var e={product_id:s.id,qty:s.qty};t.$http.post(a,{data:e}).then((function(a){a.data.success&&(t.isLoading=!1,t.$router.push("/userinfo"))}))}))},nextStep:function(){this.continue=!0,this.addCart(),this.$router.push("/userinfo")}},beforeRouteLeave:function(t,a,s){this.continue?s():(c()("#leaveModal").modal("show"),c()(".btn-stay").on("click",(function(){s(!1)})),c()(".btn-leave").on("click",(function(){s()})))},created:function(){this.getCart()}},l=o,u=(s("13d2"),s("2877")),d=Object(u["a"])(l,e,i,!1,null,"312f6a14",null);a["default"]=d.exports},b06c:function(t,a,s){},dfbe:function(t,a,s){}}]);
//# sourceMappingURL=chunk-2eaf5445.a12f1664.js.map